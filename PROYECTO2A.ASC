* PROYECTO 2

*DECLARACION CONSTANTES

SCDR   EQU   $102F
SCCR2  EQU   $102D
SCSR   EQU   $102E
SCCR1  EQU   $102C
BAUD   EQU   $102B
HPRIO  EQU   $103C
SPCR   EQU   $1028
CSCTL  EQU   $105D
OPT2   EQU   $1038
DDRD   EQU   $1009

*DECLARACION DE VARIABLES
*9999 =MMMMMMMMMCMXCIX
*9888 = MMMMMMMMMDCCCLXXXVIII
ORDEN EQU $0000
U1    EQU $0001
U2    EQU $0002
U3    EQU $0003
U4    EQU $0100
U5    EQU $0005
U6    EQU $0006
U7    EQU $0007
U8    EQU $0008
U9    EQU $0009
U10   EQU $0010
U11   EQU $0011
U12   EQU $0012
U13   EQU $0013
U14   EQU $0014
U15   EQU $0015
M   EQU $0016
D   EQU $0017
C   EQU $0018
L   EQU $0019
X   EQU $0020
V   EQU $0021
I   EQU $0022
UNIDAD EQU $0023
DECENA EQU $0024
CENTENA EQU $0025
MIL EQU $0026


  ORG $8000
INICIO
      LDS #$00FF
      JSR SERIAL
      JSR LIMPIEZA
      

CICLATE
	  LDAA	#'?
	  STAA	ORDEN
CICLO
	  LDAA	ORDEN
	  CMPA	#'?
	  BEQ	CICLO
       *HOLA PERROS
       *AL GUPY LE AGRADA EN GRAN MANERA EL PILIN C:
      
	  LDD #$0000        *Inicializa los acumuladores A y B en cerp
      ADDD #1000        *Guarda 1000 en el acumulador A y B
      STD MIL
      
      LDX	#SCSR
	  LDAA	SCSR
	  LDAA	#'1000
	  STAA	SCDR
PONEX
	  BRCLR	$00,X,#$80 PONEX
      JMP CICLATE

CASOM
      LDAB M
      INCB 
      STAB M
      LDAB MIL
      INCB 
      STAB MIL
      JMP CICLATE

CASOD
      LDAB C
      LDAB D
      INCB 
      STAB D
      JMP CICLATE

CASOC
      LDAB C
      INCB 
      STAB C
      JMP CICLATE

CASOL
      LDAB L
      INCB 
      STAB L
      JMP CICLATE

CASOX
      LDAB X
      INCB 
      STAB X
      JMP CICLATE

CASOV
      LDAB V
      INCB 
      STAB V
      JMP CICLATE

CASOI
      LDAB I
      INCB 
      STAB I
      JMP CICLATE

FIN 
      JMP FIN

SERIAL

       LDD   #$302C  * CONFIGURA PUERTO SERIAL
       STAA  BAUD    * BAUD  9600  para cristal de 8MHz
       STAB  SCCR2   * HABILITA  RX Y TX PERO INTERRUPCN SOLO RX
       LDAA  #$00
       STAA  SCCR1   * 8 BITS

       LDAA  #$FE    * CONFIG PUERTO D COMO SALIDAS (EXCEPTO PD0)
       STAA  DDRD    * SEA  ENABLE DEL DISPLAY  PD4  Y RS PD3
                     
      
       LDAA  #$04
       STAA  HPRIO

       LDAA  #$00
       TAP
      RTS


LIMPIEZA
      CLR U1
      CLR U2
      CLR U3
      CLR U4
      CLR U5
      CLR U6
      CLR U7
      CLR U8
      CLR U9
      CLR U10
      CLR U11
      CLR U12
      CLR U13
      CLR U14
      CLR U15
      CLR M
      CLR D
      CLR C
      CLR L 
      CLR X
      CLR V
      CLR I
      CLR UNIDAD
      CLR DECENA
      CLR CENTENA
      CLR MIL
    RTS

***********************************
* ATENCION A INTERRUPCION SERIAL
***********************************
       ORG  $F100

       LDAA SCSR
       LDAA SCDR
       STAA ORDEN
         
       RTI

***********************************
* VECTOR INTERRUPCION SERIAL
***********************************
       ORG   $FFD6
       FCB   $F1,$00       


***********************************
*RESET
    RTS

***********************************
* ATENCION A INTERRUPCION SERIAL
***********************************
       ORG  $F100

       LDAA SCSR
       LDAA SCDR
       STAA ORDEN
         
       RTI

***********************************
* VECTOR INTERRUPCION SERIAL
***********************************
       ORG   $FFD6
       FCB   $F1,$00       


***********************************
*RESET
    RTS

***********************************
* ATENCION A INTERRUPCION SERIAL
***********************************
       ORG  $F100

       LDAA SCSR
       LDAA SCDR
       STAA ORDEN
         
       RTI

***********************************
* VECTOR INTERRUPCION SERIAL
***********************************
       ORG   $FFD6
       FCB   $F1,$00       


***********************************
*RESET
***********************************
       ORG    $FFFE
RESET  FCB    $80,$00
***********************************
       END   $8000


       M   EQU $0016
D   EQU $0017
C   EQU $0018
L   EQU $0019
X   EQU $0020
V   EQU $0021
I   EQU $0022